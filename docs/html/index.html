<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>GENERIC_SERVER: Main Page</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.7 -->
<div class="tabs">
  <ul>
    <li id="current"><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="classes.html"><span>Classes</span></a></li>
    <li><a href="files.html"><span>Files</span></a></li>
    <li>
      <form action="search.php" method="get">
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td><label>&nbsp;<u>S</u>earch&nbsp;for&nbsp;</label></td>
            <td><input type="text" name="query" value="" size="20" accesskey="s"/></td>
          </tr>
        </table>
      </form>
    </li>
  </ul></div>
<h1>GENERIC_SERVER Documentation</h1>
<p>
<h3 align="center">0.0.0.9 </h3><h3>Table of Contents</h3>
<p>
<a class="el" href="index.html#IN">Introduction</a> <br>
 <a class="el" href="index.html#FE">Features</a> <br>
 <a class="el" href="index.html#MK">Building GENERIC_SERVER</a> <br>
 <a class="el" href="index.html#WI">WINDOWS server startup</a> <br>
 <a class="el" href="index.html#LI">LINUX server startup</a> <br>
 <a class="el" href="index.html#SE">Server configuration</a> <br>
 <a class="el" href="index.html#AR">Architecture</a> <br>
 <a class="el" href="index.html#mp">Message Structure</a> <br>
 <a class="el" href="index.html#gt">Git Page</a> <br>
 <a class="el" href="index.html#au">Author</a> <br>
 <a class="el" href="index.html#li">License</a> <br>
<h2><a class="anchor" name="IN">
Introduction</a></h2>
GENERIC_SERVER is a cross-platform, pluggable, extensible, secure framework for deploying C++ plug-ins. Multi-threaded framework can support multiple plug-ins. GENERIC_SERVER makes extensive use of pluggable shared libraries to 'plugin' specific functionality to the framework. Framework dynamically loads,unloads plug-ins and dispatches each plug-in in a separate thread.<p>
Plug-ins would just focus on implementing business logic, framework handles plug-in lifecycle management, network management, threads management and provides a host of other functionality that any plug-in could utilitze.<h2><a class="anchor" name="FE">
Features</a></h2>
<ul>
<li>Built-in support for TLS encryption. A flag in generic_server.conf file will enable or disable TLS/SSL encryption for a specific plug-in. X509 Certificates installed under CERT sub-directory are used for TLS/SSL implementation</li>
</ul>
<ul>
<li>All plug-ins are derived classes from a base class GENERIC_PLUGIN. Lot of functionality required for plug-ins are implemented in GENERIC_PLUGIN</li>
</ul>
<ul>
<li>Plug-in specific conf files. Configuration parameters specific for a plug-in should be configured in a conf file residing in plug-in specific directory</li>
</ul>
<ul>
<li>Multiple instances of framework can be running simultaneously, serving different group of plug-ins. Each instance would have a different process name</li>
</ul>
<ul>
<li>Framework managed log file, with log file rollover capability. Log can be redirected to 'syslog' on Linux and to Eventlog on Windows</li>
</ul>
<ul>
<li>Framework can authenticate all clients via X509 certificates. VERIFY_CLIENT option in main framework conf file can be used to disable/enable TLS certificate validation of client. Default is to disable TLS certificate validation</li>
</ul>
<ul>
<li>Framework can authorize all clients by enforcing clients to send &lt;PLUGIN_NAME&gt; as part of request payload. This is done by setting VALIDATE_PLUGIN flag to true for a specific plug-in in generic server configuration file.</li>
</ul>
<ul>
<li>Framework can support / service multiple plug-ins of same plug-in_type on one port. This is termed as an 'Alias' plug-in. An alias plug-in should be of same plug-in_type, have plugin shared library path and TLS flag as the primary plug-in. The first plug-in in generic_server.conf file for any plug-in_type is considered as the primary plug-in.</li>
</ul>
<br>
 <br>
 <h2><a class="anchor" name="MK">
Building GENERIC_SERVER</a></h2>
<h3><a class="anchor" name="BL">
Linux</a></h3>
GENERIC_SERVER has been packaged as an Autoconf package. You could just: <pre>
	$ ./configure
	$ make
	$ make install
</pre> to build and install the framework. The following components would be built: <ul>
<li>libgeneric_plugin.1.0.so <br>
 This is the shared library for <a class="el" href="d9/ddf/classgeneric__plugin.html">generic_plugin</a>. <br>
 <br>
 </li>
<li><a class="el" href="d8/d97/classgeneric__server.html">generic_server</a> <br>
 This is the <a class="el" href="d8/d97/classgeneric__server.html">generic_server</a> executable. <br>
 <br>
 </li>
<li>libsample.1.0.so <br>
 This is the shared library for sample plug-in. <br>
 <br>
 </li>
<li>libsample2.1.0.so <br>
 This is the shared library for sample2 plug-in. Sample2 plug-in implements a light-weight secure, file upload functionality. An utility sample2_client can be used to interface with this plug-in. <br>
 <br>
 </li>
<li>sample_client <br>
 This is a sample client program that can be used to interface with GENERIC_SERVER plug-in named: sample. <br>
 <br>
 </li>
<li>sample2_client <br>
 This is a sample client program that can be used to interface with GENERIC_SERVER plug-in named: sample2. <br>
 <br>
 </li>
</ul>
<h3><a class="anchor" name="BW">
Windows</a></h3>
A Visual Studio solution is available to build GENERIC_SERVER on Windows. This is generic_server.sln under WINDOWS/generic_server directory. Visual Studio 2010 has been used to develop and test on Windows. This solution has five projects: <ul>
<li><a class="el" href="d9/ddf/classgeneric__plugin.html">generic_plugin</a> <br>
 Builds generic_plugin.dll <br>
 <br>
 </li>
<li><a class="el" href="d8/d97/classgeneric__server.html">generic_server</a> <br>
 Builds generic_server.exe <br>
 <br>
 </li>
<li><a class="el" href="db/da1/classsample__plugin.html">sample_plugin</a> <br>
 Builds sample_plugin.dll <br>
 <br>
 </li>
<li><a class="el" href="d4/deb/classsample2__plugin.html">sample2_plugin</a> <br>
 Builds sample2_plugin.dll Sample2 plug-in implements a light-weight secure,file upload functionality. An utility sample2_client can be used to interface with this plug-in. <br>
 <br>
 </li>
<li>sample_client <br>
 This is a sample client program that can be used to interface with GENERIC_SERVER. <br>
 <br>
 </li>
<li>sample2_client <br>
 This is a sample client program that can be used to interface with GENERIC_SERVER plug-in named: sample2. <br>
 <br>
</li>
</ul>
<ul>
<li>GenericServer <br>
 This is the Windows installer project. It creates an .msi file. <br>
 <br>
 </li>
</ul>
<h2><a class="anchor" name="WI">
WINDOWS server startup</a></h2>
GENERIC_SERVER is a true Windows service. Generic_Server cleanly handles Windows service events. Service Manager can be used to have fine-grained control over <a class="el" href="d8/d97/classgeneric__server.html">generic_server</a> process.<h3><a class="anchor" name="IS">
Install new service</a></h3>
Edit generic_server.conf file in install directory and ensure correct path is configured for different files and plug-ins. Assuming framework is installed under C: directory, the following command should be used to install GENERIC_SERVER service: C:&gt;<a class="el" href="d8/d97/classgeneric__server.html">generic_server</a> -i &lt;SERVICE_NAME&gt; &lt;INSTANCE_SPECIFIC_CONF_FILE&gt;<p>
Example: C:&gt;<a class="el" href="d8/d97/classgeneric__server.html">generic_server</a> -i MAIN_SERVER generic_server.conf<p>
Once the above step is done, a service named MAIN_SERVER will be created on Windows.<h3><a class="anchor" name="VE">
Verify service Installation</a></h3>
Go to Windows Service Manager and confirm a service named &lt;SERVICE_NAME&gt; is installed.<p>
Start --&gt; Control Panel --&gt; Administrative Tools --&gt; Services<h3><a class="anchor" name="TE">
Test the Server</a></h3>
<ul>
<li>Go to service manager and start one or more GENERIC_SERVER service(s) </li>
<li>Use sample_client program to connect to configured port and send request to framework / plug-in being tested. <pre>
	Example:
	$ ./sample_client x.x.x.x 60103 TEST_PLUGIN "Hello from sample_client.." 2 1
</pre> </li>
</ul>
<h2><a class="anchor" name="LI">
LINUX server startup</a></h2>
Run the command:<p>
# <a class="el" href="d8/d97/classgeneric__server.html">generic_server</a> &lt;INSTANCE_NAME&gt; &lt;INSTANCE_SPECIFIC_CONF_FILE&gt;<p>
Example: # <a class="el" href="d8/d97/classgeneric__server.html">generic_server</a> MAIN_SERVER generic_server.conf<p>
<br>
 <br>
 <h2><a class="anchor" name="SE">
Server configuration</a></h2>
<pre>
	A sample server configuration file is shown below:</pre><p>
<pre>	LOG_FILE=/tmp/TEST/generic_server.log
	LOG_FILE=SYSLOG
	# This is the seconds interval a thread will do idle wait client
	TIMEOUT_SECONDS=300
	# Max. concurrent threads the will framework will spawn for all devices
	MAX_THREADS=100
	# next 2 entries are self-explanatory
	MAX_LOG_SIZE_IN_MB=100
	MAX_LOGS_SAVED=5
	# TLS certificate in PEM format, if TLS is enabled for any device
	SERVER_CERTIFICATE=/tmp/TEST/CERT/generic_server.crt
	# TLS private_key in PEM format, if TLS is enabled for any device
	RSA_PRIVATE_KEY=/tmp/TEST/CERT/generic_server.key
	# CA cert file
	CA_CERTIFICATE=/tmp/TEST//CERT/CAfile.pem
	VERIFY_CLIENT option will validate client TLS certificate. Default is
	not to validate certificates. 
	VERIFY_CLIENT=0
	# COMMAND_PORT should be unique per instance. Please set any free port 
	COMMAND_PORT=10000
	# PLUGINS_PATH set the base DIR of plugins shared library / DLL
	PLUGINS_PATH=/tmp/TEST/plugins
	#
	<a class="el" href="d7/d71/generic__server_8h.html#1ee768562b9caa3b85eaf164209891fe">PLUGIN_NAME</a>|PLUGIN_TYPE|TCP_PORT|PLUGIN_NUMBER|PLUGIN_SHARED_LIBRARY|TLS_FLAG|PLUGIN_SPECIFIC_CONF_FILE
	PLUGIN_SPECIFIC_CONF_FILE and PLUGIN LIB path is relative to server install directory
	#
	SAMPLE1|SAMPLE|60103|1|sample/libsample.1.0.so|1|sample/sample.conf
	SAMPLE2|FILE_UPLOAD|60104|1|sample2/libsample2.1.0.so|1|sample2/sample2.conf
</pre> <br>
 <br>
 <h2><a class="anchor" name="AR">
Architecture</a></h2>
GENERIC_SERVER has the following main components:<h3><a class="anchor" name="FR">
Framework</a></h3>
This is a singleton class and provides framework functionality. Source files are in: framework directory.<h3><a class="anchor" name="GE">
Generic Plugin</a></h3>
This component provides functionality that are common across plug-ins. Source files are in <a class="el" href="d9/ddf/classgeneric__plugin.html">generic_plugin</a> directory. Framework would instantiate and load objects of type GENERIC_PLUGIN to framework from plugin shared library. Generic_plugin is packaged into a shared library: libgeneric_plugin.so or generic_plugin.dll.<h3><a class="anchor" name="PL">
Plug-ins</a></h3>
Plug-ins are where business logic gets implemented. All plug-ins should derive from class GENERIC_PLUGIN and should have a function named create_instance(). A sample plug-in is in directory: plugins/sample.<h3><a class="anchor" name="Control">
Control</a></h3>
Master program that bootstraps GENERIC_SERVER. Source is in <a class="el" href="dd/d8c/control_8cpp-source.html">control.cpp</a>. Listens and does 'select()'on all sockets configured in generic_server.conf file. Spawns a thread for each plug-in and runs message loop for that plug-in. <br>
 <br>
 <h2><a class="anchor" name="DY">
Dynamically re-load plug-ins</a></h2>
Generic_Server has been designed to easily enable addition or deletion of plug-ins to the framework without restartng the framework:<h3><a class="anchor" name="wi">
WINDOWS</a></h3>
Add or remove plug-ins from generic_server.conf file, then go to service manager and 'pause' and 'resume' the service &lt;SERVICE_NAME&gt;. Check out log file to ensure server has picked up the changes.<h3><a class="anchor" name="lii">
Linux</a></h3>
Add or remove plug-ins from <a class="el" href="d8/d97/classgeneric__server.html">generic_server</a> conf file and then send signal SIGHUP to <a class="el" href="d8/d97/classgeneric__server.html">generic_server</a> process via 'kill' command. Check out log file to ensure server has picked up the changes.<h2><a class="anchor" name="mp">
Message Structure</a></h2>
GENERIC_SERVER has been designed to provide flexibility to plug-ins on messaging structure and protocol. GENERIC_SERVER today implements a very simplified message structure shown below: <h3><a class="anchor" name="hdr">
Message Header</a></h3>
<ul>
<li>SIGNATURE - 4 bytes SIGNATURE for all messages </li>
<li>PAYLOAD_SIZE - 4 bytes network byte order </li>
<li>DATA - PAYLOAD_SIZE data </li>
</ul>
<h3><a class="anchor" name="subhdr">
Data payload</a></h3>
<ul>
<li>PLUGIN_NAME_LEN - 4 bytes network byte order (optional) </li>
<li>PLUGIN_NAME - Size as defined by &lt;PLUGIN_NAME_LEN&gt; (optional) </li>
<li>APPLICATION_DATA - PAYLOAD_SIZE-([4+PLUGIN_NAME_LEN])</li>
</ul>
If VALIDATE_PLUGIN is set to 1 in framework configuration file, then all client requests should have PLUGIN_NAME_LEN and PLUGIN_NAME within the message.<h2><a class="anchor" name="ssl">
OpenSSL</a></h2>
<h3><a class="anchor" name="sslwi">
WINDOWS</a></h3>
OpenSSL 1.0 was used to develop and test GENERIC_SERVER for Windows. Please download and install OpenSSL windows development package from: <a href="http://www.shininglightpro.com/download/Win32OpenSSL_Light-1_0_0a.exe">http://www.shininglightpro.com/download/Win32OpenSSL_Light-1_0_0a.exe</a> Once OpenSSL is installed, please ensure path to OpenSSL include and lib directories is correctly configured in all Visual Studio projects <h3><a class="anchor" name="sslli">
Linux</a></h3>
Please use platform specific tools to install OpenSSL development package for Linux.<h2><a class="anchor" name="gt">
Git Page</a></h2>
Git link for this project is at: <a href="https://github.com/surajvijayan/GENERIC_SERVER">https://github.com/surajvijayan/GENERIC_SERVER</a><h2><a class="anchor" name="au">
Author</a></h2>
This has been developed by <dl compact><dt><b>Author:</b></dt><dd>Suraj Vijayan <a href="mailto:suraj@broadcom.com">suraj@broadcom.com</a>.</dd></dl>
<h2><a class="anchor" name="li">
License</a></h2>
This program is free software; you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation; either version 2.1 of the License, or (at your option) any later version.<p>
This library is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.<p>
You should have received a copy of the GNU Lesser General Public License along with this library; if not, write to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA <hr size="1"><address style="align: right;"><small>Generated on Mon Nov 18 12:03:31 2013 for GENERIC_SERVER by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.7 </small></address>
</body>
</html>
